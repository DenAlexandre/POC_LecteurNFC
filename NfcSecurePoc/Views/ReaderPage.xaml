<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:NfcSecurePoc.ViewModels"
             xmlns:local="clr-namespace:NfcSecurePoc"
             x:Class="NfcSecurePoc.Views.ReaderPage"
             x:DataType="vm:ReaderViewModel"
             Title="Reader">

    <ContentPage.Resources>
        <local:BoolToStringConverter x:Key="ScanButtonTextConverter"
                                     TrueText="Stop Scanning"
                                     FalseText="Start Scanning" />
    </ContentPage.Resources>

    <Grid RowDefinitions="Auto,Auto,Auto,*" Padding="16" RowSpacing="12">

        <!-- Status -->
        <Frame Grid.Row="0" Padding="12" BackgroundColor="{AppThemeBinding Light=#F0F0F0, Dark=#1E1E1E}">
            <VerticalStackLayout Spacing="4">
                <Label Text="NFC Reader" FontAttributes="Bold" FontSize="18" />
                <Label Text="{Binding StatusText}" FontSize="14" TextColor="Gray" />
            </VerticalStackLayout>
        </Frame>

        <!-- Results -->
        <Frame Grid.Row="1" Padding="12" BackgroundColor="{AppThemeBinding Light=#F0F0F0, Dark=#1E1E1E}">
            <VerticalStackLayout Spacing="8">
                <HorizontalStackLayout Spacing="8">
                    <Label Text="Tag ID:" FontAttributes="Bold" FontSize="14" />
                    <Label Text="{Binding TagId}" FontSize="14" />
                </HorizontalStackLayout>
                <HorizontalStackLayout Spacing="8">
                    <Label Text="Data:" FontAttributes="Bold" FontSize="14" />
                    <Label Text="{Binding DecryptedData}" FontSize="14" TextColor="Green" />
                </HorizontalStackLayout>
            </VerticalStackLayout>
        </Frame>

        <!-- Scan Button -->
        <Button Grid.Row="2"
                Text="{Binding IsScanning, Converter={StaticResource ScanButtonTextConverter}}"
                Command="{Binding ToggleScanCommand}"
                BackgroundColor="{Binding IsScanning, Converter={StaticResource ActiveColorConverter}}"
                TextColor="White"
                FontAttributes="Bold"
                HeightRequest="50" />

        <!-- Logs -->
        <Frame Grid.Row="3" Padding="8" BackgroundColor="{AppThemeBinding Light=#FAFAFA, Dark=#121212}">
            <ScrollView>
                <Label Text="{Binding Logs}"
                       FontFamily="Consolas"
                       FontSize="11"
                       LineBreakMode="WordWrap" />
            </ScrollView>
        </Frame>

    </Grid>
</ContentPage>
